var anchoredLink,assets,assetsChanged,browserCompatibleDocumentParser,browserSupportsPushState,cacheCurrentPage,changePage,constrainPageCacheTo,createDocument,crossOriginLink,currentState,executeScriptTags,extractAssets,extractLink,extractTitleAndBody,fetchHistory,fetchReplacement,handleClick,ignoreClick,initialized,installClickHandlerLast,intersection,noTurbolink,nonHtmlLink,nonStandardClick,pageCache,recallScrollPosition,referer,reflectNewUrl,reflectRedirectedUrl,rememberCurrentAssets,rememberCurrentState,rememberCurrentUrl,rememberInitialPage,resetScrollPosition,targetLink,triggerEvent,visit,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};initialized=!1,currentState=null,referer=document.location.href,assets=[],pageCache={},createDocument=null,visit=function(a){return browserSupportsPushState?(cacheCurrentPage(),reflectNewUrl(a),fetchReplacement(a)):document.location.href=a},fetchReplacement=function(a){var b;return triggerEvent("page:fetch"),b=new XMLHttpRequest,b.open("GET",a,!0),b.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),b.setRequestHeader("X-XHR-Referer",referer),b.onload=function(){var a;return a=createDocument(b.responseText),assetsChanged(a)?document.location.reload():(changePage.apply(null,extractTitleAndBody(a)),reflectRedirectedUrl(b),resetScrollPosition(),triggerEvent("page:load"))},b.onabort=function(){return console.log("Aborted turbolink fetch!")},b.send()},fetchHistory=function(a){var b;return cacheCurrentPage(),(b=pageCache[a.position])?(changePage(b.title,b.body),recallScrollPosition(b),triggerEvent("page:restore")):fetchReplacement(document.location.href)},cacheCurrentPage=function(){return rememberInitialPage(),pageCache[currentState.position]={url:document.location.href,body:document.body,title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset},constrainPageCacheTo(10)},constrainPageCacheTo=function(a){var b,c,d;d=[];for(b in pageCache)__hasProp.call(pageCache,b)&&(c=pageCache[b],b<=currentState.position-a?d.push(pageCache[b]=null):d.push(void 0));return d},changePage=function(a,b,c){return document.title=a,document.documentElement.replaceChild(b,document.body),c&&executeScriptTags(),currentState=window.history.state,triggerEvent("page:change")},executeScriptTags=function(){var a,b,c,d,e,f,g,h,i,j,k,l;for(i=document.body.getElementsByTagName("script"),l=[],e=0,g=i.length;g>e;e++)if(d=i[e],d&&(""===(j=d.type)||"text/javascript"===j))if(null!=d.src&&""!==d.src&&null==d.getAttribute("data-turbolinks-evaluated")){for(b=document.createElement("script"),k=d.attributes,f=0,h=k.length;h>f;f++)a=k[f],b.setAttribute(a.name,a.value);b.setAttribute("data-turbolinks-evaluated",""),c=d.parentNode,c.removeChild(d),l.push(c.insertBefore(b,c.childNodes[0]))}else l.push(window.eval(d.innerHTML));return l},reflectNewUrl=function(a){return a!==document.location.href?(referer=document.location.href,window.history.pushState({turbolinks:!0,position:currentState.position+1},"",a)):void 0},reflectRedirectedUrl=function(a){var b;return(b=a.getResponseHeader("X-XHR-Current-Location"))?window.history.replaceState(currentState,"",b):void 0},rememberCurrentUrl=function(){return window.history.replaceState({turbolinks:!0,position:Date.now()},"",document.location.href)},rememberCurrentState=function(){return currentState=window.history.state},rememberCurrentAssets=function(){return assets=extractAssets(document)},rememberInitialPage=function(){return initialized?void 0:(rememberCurrentUrl(),rememberCurrentState(),createDocument=browserCompatibleDocumentParser(),initialized=!0)},recallScrollPosition=function(a){return window.scrollTo(a.positionX,a.positionY)},resetScrollPosition=function(){return window.scrollTo(0,0)},triggerEvent=function(a){var b;return b=document.createEvent("Events"),b.initEvent(a,!0,!0),document.dispatchEvent(b)},extractAssets=function(a){var b,c,d,e,f;for(e=a.head.childNodes,f=[],c=0,d=e.length;d>c;c++)b=e[c],(b.src||b.href)&&f.push(b.src||b.href);return f},assetsChanged=function(a){var b;return b=extractAssets(a),b.length!==assets.length||intersection(b,assets).length!==assets.length},intersection=function(a,b){var c,d,e,f,g;for(a.length>b.length&&(f=[b,a],a=f[0],b=f[1]),g=[],d=0,e=a.length;e>d;d++)c=a[d],__indexOf.call(b,c)>=0&&g.push(c);return g},extractTitleAndBody=function(a){var b;return b=a.querySelector("title"),[null!=b?b.textContent:void 0,a.body,"runScripts"]},browserCompatibleDocumentParser=function(){var a,b,c,d;return a=function(a){return(new DOMParser).parseFromString(a,"text/html")},b=function(a){var b;return b=document.implementation.createHTMLDocument(""),b.open("replace"),b.write(a),b.close(),b},window.DOMParser&&(c=a("<html><body><p>test")),1===(null!=c?null!=(d=c.body)?d.childNodes.length:void 0:void 0)?a:b},installClickHandlerLast=function(a){return a.defaultPrevented?void 0:(document.removeEventListener("click",handleClick),document.addEventListener("click",handleClick))},handleClick=function(a){var b;return a.defaultPrevented||(b=extractLink(a),"A"!==(null!=b?b.nodeName:void 0)||ignoreClick(a,b))?void 0:(visit(b.href),a.preventDefault())},extractLink=function(a){var b;for(b=a.target;b.parentNode&&"A"!==b.nodeName;)b=b.parentNode;return b},crossOriginLink=function(a){return location.protocol!==a.protocol||location.host!==a.host},anchoredLink=function(a){return(a.hash&&a.href.replace(a.hash,""))===location.href.replace(location.hash,"")||a.href===location.href+"#"},nonHtmlLink=function(a){return a.href.match(/\.[a-z]+(\?.*)?$/g)&&!a.href.match(/\.html?(\?.*)?$/g)},noTurbolink=function(a){for(var b;!b&&a!==document;)b=null!=a.getAttribute("data-no-turbolink"),a=a.parentNode;return b},targetLink=function(a){return 0!==a.target.length},nonStandardClick=function(a){return a.which>1||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey},ignoreClick=function(a,b){return crossOriginLink(b)||anchoredLink(b)||nonHtmlLink(b)||noTurbolink(b)||targetLink(b)||nonStandardClick(a)},browserSupportsPushState=window.history&&window.history.pushState&&window.history.replaceState&&void 0!==window.history.state,browserSupportsPushState&&(rememberCurrentAssets(),document.addEventListener("click",installClickHandlerLast,!0),window.addEventListener("popstate",function(a){var b;return(null!=(b=a.state)?b.turbolinks:void 0)?fetchHistory(a.state):void 0})),this.Turbolinks={visit:visit};